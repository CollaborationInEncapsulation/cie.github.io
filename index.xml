<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Collaboration In Encapsulation</title>
    <link>http://coinen.space/</link>
    <description>Recent content on Collaboration In Encapsulation</description>
    <generator>Hugo - gohugo.io</generator>
    <language>en</language>
    <contact>shadowgun.developer@gmail.com</contact>
    <copyright>&copy; <a href="https://github.com/OlegDokuka">Oleh Dokuka</a> 2019</copyright>
    
        <atom:link href="http://coinen.space/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>How-To: Create RSocket-Java Receiver/Connector</title>
      <link>http://coinen.space/rsocket/posts/how-to-rsocket-java-receiver-connector/</link>
      <pubDate>Sun, 24 Mar 2019 23:05:08 +0300</pubDate>
      <author>Oleh Dokuka</author>
      <guid>http://coinen.space/rsocket/posts/how-to-rsocket-java-receiver-connector/</guid>
      <description></description>
      
      <content>&lt;div id=&#34;toc&#34; class=&#34;toc&#34;&gt;
&lt;div id=&#34;toctitle&#34;&gt;Table of Contents&lt;/div&gt;
&lt;ul class=&#34;sectlevel1&#34;&gt;
&lt;li&gt;&lt;a href=&#34;#_acknowledgment&#34;&gt;Acknowledgment&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#_declaring_core_dependency&#34;&gt;Declaring Core Dependency&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#_constructing_rsocket_receiver&#34;&gt;Constructing RSocket Receiver&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#_declaring_transport_dependency&#34;&gt;Declaring Transport Dependency&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#_constructing_rsocket_receiver_transport&#34;&gt;Constructing RSocket Receiver Transport&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#_constructing_rsocket_connector&#34;&gt;Constructing RSocket Connector&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#_complete_sample&#34;&gt;Complete Sample&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#_summary&#34;&gt;Summary&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#_what_is_next&#34;&gt;What is next?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&#34;sect1&#34;&gt;
&lt;h2 id=&#34;_acknowledgment&#34;&gt;Acknowledgment&lt;/h2&gt;
&lt;div class=&#34;sectionbody&#34;&gt;
&lt;div class=&#34;paragraph&#34;&gt;
&lt;p&gt;This is a first blog post in the series of How to get started with RSocket related blog posts in which I&amp;#8217;m going to share the simplest tips on running, configuring, and debugging RSocket.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;paragraph&#34;&gt;
&lt;p&gt;This series of blog posts do not include the motivation of the RSocket itself which will be delivered in a separate series.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;sect1&#34;&gt;
&lt;h2 id=&#34;_declaring_core_dependency&#34;&gt;Declaring Core Dependency&lt;/h2&gt;
&lt;div class=&#34;sectionbody&#34;&gt;
&lt;div class=&#34;paragraph&#34;&gt;
&lt;p&gt;The first steps in the setup of any project is declaring the required dependencies. In our project we use Gradle, but the same can be reproduced with Maven:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;listingblock&#34;&gt;
&lt;div class=&#34;content&#34;&gt;
&lt;pre class=&#34;highlight&#34;&gt;&lt;code class=&#34;language-groovy&#34; data-lang=&#34;groovy&#34;&gt;dependencies {
  implementation &#39;io.rsocket:rsocket-core:0.12.1-RC3-SNAPSHOT&#39;
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;admonitionblock note&#34;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&#34;icon&#34;&gt;
&lt;div class=&#34;title&#34;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&#34;content&#34;&gt;
&lt;div class=&#34;paragraph&#34;&gt;
&lt;p&gt;At a moment of this blog writing, the latest version of RSocket-Java was &lt;code&gt;0.12.1-RC3-SNAPSHOT&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;sect1&#34;&gt;
&lt;h2 id=&#34;_constructing_rsocket_receiver&#34;&gt;Constructing RSocket Receiver&lt;/h2&gt;
&lt;div class=&#34;sectionbody&#34;&gt;
&lt;div class=&#34;paragraph&#34;&gt;
&lt;p&gt;In RSocket-Java, any construction of connector/receiver starts with static factory called &lt;code&gt;io.rsocket.RSocketFactory&lt;/code&gt;. &lt;code&gt;RSocketFactory&lt;/code&gt; has two central builder methods one of which is for receiver declaration:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;listingblock&#34;&gt;
&lt;div class=&#34;content&#34;&gt;
&lt;pre class=&#34;highlight&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;package com.example.rsocket;

import io.rsocket.RSocketFactory;


public class RSocketPlayground {
  public static void main(String[] args) {
    RSocketFactory.ServerRSocketFactory serverRSocketFactory =
      RSocketFactory.receive();
  }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;paragraph&#34;&gt;
&lt;p&gt;The above example show the first step of building an RSocket receiver. Call to &lt;code&gt;RSocketFactory.receive()&lt;/code&gt; returns a &lt;code&gt;RSocketFactory.ServerRSocketFactory&lt;/code&gt; instance which gives a wide list of customization for RSocket receiver. For now we just use only &lt;code&gt;io.rsocket.RSocketFactory.ServerRSocketFactory#acceptor&lt;/code&gt; which allows us to specify handler for incoming connections:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;listingblock&#34;&gt;
&lt;div class=&#34;content&#34;&gt;
&lt;pre class=&#34;highlight&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;package com.example.rsocket;

import io.rsocket.AbstractRSocket;
import io.rsocket.ConnectionSetupPayload;
import io.rsocket.RSocket;
import io.rsocket.RSocketFactory;
import io.rsocket.SocketAcceptor;
import reactor.core.publisher.Mono;


public class RSocketPlayground {
  public static void main(String[] args) {
    RSocketFactory.ServerRSocketFactory serverRSocketFactory =
      RSocketFactory.receive();

    RSocketFactory.ServerTransportAcceptor serverTransportAcceptor =
      serverRSocketFactory.acceptor(new SocketAcceptor() {             &lt;b class=&#34;conum&#34;&gt;(1)&lt;/b&gt;
        @Override
        public Mono&amp;lt;RSocket&amp;gt; accept(                                   &lt;b class=&#34;conum&#34;&gt;(2)&lt;/b&gt;
            ConnectionSetupPayload payload,                            &lt;b class=&#34;conum&#34;&gt;(3)&lt;/b&gt;
            RSocket connectorRSocket                                   &lt;b class=&#34;conum&#34;&gt;(4)&lt;/b&gt;
        ) {
          return Mono.just(new AbstractRSocket() {});                  &lt;b class=&#34;conum&#34;&gt;(5)&lt;/b&gt;
        }
      });
  }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;colist arabic&#34;&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Creates an instance of the &lt;code&gt;io.rsocket.SocketAcceptor&lt;/code&gt; class and passes it to the &lt;code&gt;acceptor&lt;/code&gt; method;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Declares the &lt;code&gt;accept&lt;/code&gt; handler method which accept two params and asynchronously return server &lt;code&gt;RSocket&lt;/code&gt;;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Represents the information that connector can send to receiver at the connection stage;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Instantiates &lt;code&gt;RSocket&lt;/code&gt; that represents/gives access to the connector functionality;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Constructs instance of RSocket that represents/gives access to receiver functionality;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&#34;paragraph&#34;&gt;
&lt;p&gt;The above sample continues the RSocket receiver construction and shows how we can declare a no-ops socket acceptor. In turn, applying that stage returns a &lt;code&gt;io.rsocket.RSocketFactory.ServerTransportAcceptor&lt;/code&gt; which allows us to finalize setup by declaring a transport.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;sect1&#34;&gt;
&lt;h2 id=&#34;_declaring_transport_dependency&#34;&gt;Declaring Transport Dependency&lt;/h2&gt;
&lt;div class=&#34;sectionbody&#34;&gt;
&lt;div class=&#34;paragraph&#34;&gt;
&lt;p&gt;Since RSocket is an Application Layer protocol, it may work on top of any lower level transport. In general core dependency provides just an interface for transport. Thus we have to add another link to required implementation. Today we are going to use local, inter process transport for simplicity:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;listingblock&#34;&gt;
&lt;div class=&#34;content&#34;&gt;
&lt;pre class=&#34;highlight&#34;&gt;&lt;code class=&#34;language-groovy&#34; data-lang=&#34;groovy&#34;&gt;dependencies {
  implementation &#39;io.rsocket:rsocket-transport-local:0.12.1-RC3-SNAPSHOT&#39;
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;sect1&#34;&gt;
&lt;h2 id=&#34;_constructing_rsocket_receiver_transport&#34;&gt;Constructing RSocket Receiver Transport&lt;/h2&gt;
&lt;div class=&#34;sectionbody&#34;&gt;
&lt;div class=&#34;paragraph&#34;&gt;
&lt;p&gt;Finally, we can use &lt;code&gt;io.rsocket.transport.local.LocalServerTransport&lt;/code&gt; in order to run RSocket receiver on it:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;listingblock&#34;&gt;
&lt;div class=&#34;content&#34;&gt;
&lt;pre class=&#34;highlight&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;package com.example.rsocket;

import io.rsocket.AbstractRSocket;
import io.rsocket.ConnectionSetupPayload;
import io.rsocket.RSocket;
import io.rsocket.RSocketFactory;
import io.rsocket.SocketAcceptor;
import reactor.core.publisher.Mono;


public class RSocketPlayground {
  public static void main(String[] args) {
    RSocketFactory.ServerRSocketFactory serverRSocketFactory =
      RSocketFactory.receive();

    RSocketFactory.ServerTransportAcceptor serverTransportAcceptor =
      serverRSocketFactory.acceptor(new SocketAcceptor() {
        @Override
        public Mono&amp;lt;RSocket&amp;gt; accept(
            ConnectionSetupPayload payload,
            RSocket connectorRSocket
        ) {
          return Mono.just(new AbstractRSocket() {});
        }
      });

    Closeable closeableServer = serverTransportAcceptor
      .transport(LocalServerTransport.create(&#34;RSocket-Receiver&#34;))    &lt;b class=&#34;conum&#34;&gt;(1)&lt;/b&gt;
      .start()                                                       &lt;b class=&#34;conum&#34;&gt;(2)&lt;/b&gt;
      .block();                                                      &lt;b class=&#34;conum&#34;&gt;(3)&lt;/b&gt;
  }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;colist arabic&#34;&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Creates an instance of &lt;code&gt;LocalServerTransport&lt;/code&gt; and passes it to builder.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Starts RSocket Receiver on the specified transport&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Blocks executing thread by the end of startup process&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&#34;paragraph&#34;&gt;
&lt;p&gt;The above code show finalized creation of the RSocket Receiver that is running on the local or simply inter-process transport implementation.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;sect1&#34;&gt;
&lt;h2 id=&#34;_constructing_rsocket_connector&#34;&gt;Constructing RSocket Connector&lt;/h2&gt;
&lt;div class=&#34;sectionbody&#34;&gt;
&lt;div class=&#34;paragraph&#34;&gt;
&lt;p&gt;Following above-mentioned samples we can easily create an instance of RSocket connector. The only difference is that we have to use the &lt;code&gt;io.rsocket.RSocketFactory#connect&lt;/code&gt; factory method instead:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;listingblock&#34;&gt;
&lt;div class=&#34;content&#34;&gt;
&lt;pre class=&#34;highlight&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;RSocket rSocket = RSocketFactory
  .connect()
  .transport(LocalClientTransport.create(&#34;RSocket-Receiver&#34;))
  .start()
  .block();&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;sect1&#34;&gt;
&lt;h2 id=&#34;_complete_sample&#34;&gt;Complete Sample&lt;/h2&gt;
&lt;div class=&#34;sectionbody&#34;&gt;
&lt;div class=&#34;paragraph&#34;&gt;
&lt;p&gt;Finally, if we add some logging to the Receiver acceptor as in the following complete sample:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;listingblock&#34;&gt;
&lt;div class=&#34;content&#34;&gt;
&lt;pre class=&#34;highlight&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;package com.example.rsocket;

import io.rsocket.AbstractRSocket;
import io.rsocket.ConnectionSetupPayload;
import io.rsocket.RSocket;
import io.rsocket.RSocketFactory;
import io.rsocket.SocketAcceptor;
import reactor.core.publisher.Mono;


public class RSocketPlayground {
  public static void main(String[] args) {
    RSocketFactory.ServerRSocketFactory serverRSocketFactory =
      RSocketFactory.receive();

    RSocketFactory.ServerTransportAcceptor serverTransportAcceptor =
      serverRSocketFactory.acceptor(new SocketAcceptor() {
        @Override
        public Mono&amp;lt;RSocket&amp;gt; accept(
            ConnectionSetupPayload payload,
            RSocket connectorRSocket
        ) {
          System.out.println(
            &#34;Received Connection. Data: [&#34; + payload.getDataUtf8() + &#34;]. &#34; +
            &#34;Metadata: [&#34; + payload.getMetadataUtf8() + &#34;]&#34;
          );

          return Mono.just(new AbstractRSocket() {});
        }
      });

    Closeable closeableServer = serverTransportAcceptor
      .transport(LocalServerTransport.create(&#34;RSocket-Receiver&#34;))
      .start()
      .block();
  }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;sect1&#34;&gt;
&lt;h2 id=&#34;_summary&#34;&gt;Summary&lt;/h2&gt;
&lt;div class=&#34;sectionbody&#34;&gt;
&lt;div class=&#34;paragraph&#34;&gt;
&lt;p&gt;In this blog post we covered the simplest steps required to run RSocket receiver and connector.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;paragraph&#34;&gt;
&lt;p&gt;To recap:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;olist arabic&#34;&gt;
&lt;ol class=&#34;arabic&#34;&gt;
&lt;li&gt;
&lt;p&gt;All you need is in &lt;code&gt;io.rsocket.RSocketFactory&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;RSocket is Application layer protocol so it can be built in to of any lower transport.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The &lt;code&gt;rocket-core&lt;/code&gt; module does not provide particular implementation of the transport, thus it is required to use additional module.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The simplest way to get started is using inter-process transport implementation which does not required running real server.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;sect1&#34;&gt;
&lt;h2 id=&#34;_what_is_next&#34;&gt;What is next?&lt;/h2&gt;
&lt;div class=&#34;sectionbody&#34;&gt;
&lt;div class=&#34;paragraph&#34;&gt;
&lt;p&gt;In the next blog post we will focus on how to start sending data between peers using RSocket-Java.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</content>
      
    </item>
    
  </channel>
</rss>